<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>AR.js GPS Debugging</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ar.js/2.2.2/aframe-ar-nft.js"></script>
    <script src="https://unpkg.com/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
    <style>
        #debug-info {
            position: fixed;
            top: 10px;
            left: 10px;
            background: white;
            padding: 10px;
            z-index: 1000;
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">
    <div id="debug-info">
        <p id="location-status">Waiting for location...</p>
        <p id="error-status"></p>
    </div>

    <a-scene 
        vr-mode-ui="enabled: false"
        renderer="logarithmicDepthBuffer: true;"
        embedded 
        arjs="sourceType: webcam; videoTexture: true; debugUIEnabled: true;"
    >
        <a-assets>
            <a-asset-item 
                id="character1-model" 
                src="yamadakkkkkkkkk.gltf"
            ></a-asset-item>
        </a-assets>

        <a-entity 
            gps-entity-place="latitude: 33.89064314660105; longitude: 130.71376029038314"
            rotation="0 0 0"
            scale="0.5 0.5 0.5"
            gltf-model="#character1-model"
            animation-mixer
        ></a-entity>

        <a-camera 
            gps-camera 
            rotation-reader 
            look-controls-enabled='false' 
            arjs-look-controls='smoothingFactor: 0.1'
        ></a-camera>
    </a-scene>

    <script>
        // 位置情報の権限と取得のデバッグ
        function checkLocationPermission() {
            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        document.getElementById('location-status').textContent = 
                            `Location Found: 
                            Lat: ${position.coords.latitude}, 
                            Lon: ${position.coords.longitude}`;
                    },
                    function(error) {
                        document.getElementById('error-status').textContent = 
                            `Error: ${error.message}`;
                    }
                );
            } else {
                document.getElementById('error-status').textContent = 
                    "Geolocation is not supported by this browser.";
            }

            // デバッグイベントリスナー
            window.addEventListener('gps-camera-update-position', function(event) {
                console.log('GPS Camera Position:', 
                    'Latitude: ' + event.detail.position.latitude, 
                    'Longitude: ' + event.detail.position.longitude
                );
                
                document.getElementById('location-status').textContent = 
                    `GPS Camera: 
                    Lat: ${event.detail.position.latitude}, 
                    Lon: ${event.detail.position.longitude}`;
            });
        }

        // ページ読み込み時に位置情報権限をチェック
        window.addEventListener('load', checkLocationPermission);
    </script>
</body>
</html>
