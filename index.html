<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.01">
    <title>AR.js Example</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
        <!-- Hiro 마커를 사용한 캐릭터 -->
        <a-marker preset="hiro" id="marker1">
            <a-entity id="character" position="0 0.5 0" rotation="-90 0 0" scale="0.5 0.5 0.5" 
                      gltf-model="orio.gltf"></a-entity>
        </a-marker>

        <!-- 고정된 캐릭터 (마커가 사라졌을 때 나타남) -->
        <a-entity id="characterFixed" position="0 0 1" rotation="0 0 0" scale="1 1 1" 
                  gltf-model="orio.gltf" visible="false">
        </a-entity>

        <!-- AR 카메라 (사용자가 카메라를 들고 이동) -->
        <a-entity id="camera" camera></a-entity>
    </a-scene>

    <script>
        const marker = document.querySelector('#marker1');
        const characterFixed = document.querySelector('#characterFixed');
        const camera = document.querySelector('#camera');

        // 마커를 잃었을 때 고정된 캐릭터 위치 표시
        marker.addEventListener('markerLost', function () {
            // 카메라의 위치를 가져오기 전에 'camera'의 position이 정확히 반영되도록 해야합니다.
            const cameraPosition = camera.getAttribute('position');
            
            console.log("Camera Position:", cameraPosition); // 디버깅용 콘솔 로그

            const newPosition = {
                x: cameraPosition.x, 
                y: cameraPosition.y, 
                z: cameraPosition.z + 1  // 카메라에서 1미터 앞에 캐릭터를 표시
            };

            characterFixed.setAttribute('position', newPosition);
            characterFixed.setAttribute('visible', true);  // 캐릭터를 표시합니다.
        });

        // 마커를 찾았을 때 고정된 캐릭터 숨기기
        marker.addEventListener('markerFound', function () {
            characterFixed.setAttribute('visible', false);
        });
    </script>
</body>
</html>
